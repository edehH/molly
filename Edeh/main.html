<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù…Ù„Ø¹Ø¨Ùƒ Ø¨ÙŠÙ† ÙŠØ¯ÙŠÙƒ - Ø­Ø¬Ø² Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      direction: rtl;
      margin: 0;
      padding: 0;
      background: #f7f7f7;
    }
    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2, h3 {
      margin: 10px 0;
      text-align: center;
    }
    hr {
      margin: 20px 0;
      border: none;
      border-top: 1px solid #ccc;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
    .booking-form div {
      margin-bottom: 10px;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input[type="text"],
    input[type="email"],
    input[type="time"] {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }
    button {
      padding: 10px 15px;
      background-color: #3498db;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #2980b9;
    }
    .delete-btn {
      background-color: #e74c3c;
    }
    .delete-btn:hover {
      background-color: #c0392b;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 style="color: #2c3e50;">Ù…Ù„Ø¹Ø¨Ùƒ Ø¨ÙŠÙ† ÙŠØ¯ÙŠÙƒ</h2>
    <hr>
    <h3 style="color: #e74c3c;">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©</h3>
    <div id="bookingsTable">
      <!-- Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ù‡Ù†Ø§ -->
    </div>
    <hr>
    <div class="booking-form">
      <h3>Ø­Ø¬Ø² Ù…Ø¨Ø§Ø±Ø§Ø©</h3>
      <form id="bookingForm">
        <div>
          <label>Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ:</label>
          <input type="text" name="user" required>
        </div>
        <div>
          <label>Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ:</label>
          <input type="text" name="phone" required>
        </div>
        <div>
          <label>Ø§Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
          <input type="email" name="email" required>
        </div>
        <div>
          <label>Ø§Ø¯Ø®Ù„ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙÙŠÙ‡ (Ù…Ø«Ø§Ù„: 15:00):</label>
          <input type="time" name="time" required>
        </div>
        <button type="submit">Ø­Ø¬Ø²</button>
      </form>
    </div>
  </div>

  <script>
    // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    const ADMIN_EMAIL = "edehwww@gmail.com";
    let bookings = [];
    let currentUserEmail = prompt("Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª:");

    // ÙˆØ¸ÙŠÙØ© Ù„Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ© (Ø£ÙƒØ«Ø± Ù…Ù† 24 Ø³Ø§Ø¹Ø©)
    function removeExpiredBookings() {
      const now = Date.now();
      bookings = bookings.filter(booking => now - booking.created_at < 24 * 60 * 60 * 1000);
    }

    // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª
    function updateBookingsTable() {
      removeExpiredBookings();
      const bookingsDiv = document.getElementById("bookingsTable");
      if (bookings.length === 0) {
        bookingsDiv.innerHTML = '<p style="text-align: center; color: #3498db;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>';
        return;
      }
      let tableHTML = '<table><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th><th>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th><th>Ø§Ù„ÙˆÙ‚Øª</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr>';
      bookings.forEach((booking, index) => {
        // Ø¹Ø±Ø¶ Ø²Ø± Ø§Ù„Ø­Ø°Ù ÙÙ‚Ø· Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„
        let actionHTML = "ğŸš«";
        if (currentUserEmail === ADMIN_EMAIL) {
          actionHTML = `<button class="delete-btn" onclick="deleteBooking(${index})">âŒ Ø­Ø°Ù</button>`;
        }
        tableHTML += `<tr>
                        <td>${booking.user}</td>
                        <td>${booking.phone}</td>
                        <td>${booking.email}</td>
                        <td>${booking.time}</td>
                        <td>${actionHTML}</td>
                      </tr>`;
      });
      tableHTML += '</table>';
      bookingsDiv.innerHTML = tableHTML;
    }

    // ÙˆØ¸ÙŠÙØ© Ø­Ø°Ù Ø­Ø¬Ø² (Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
    function deleteBooking(index) {
      if (currentUserEmail === ADMIN_EMAIL) {
        bookings.splice(index, 1);
        alert("ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­!");
        updateBookingsTable();
      } else {
        alert("âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø­Ø°Ù Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª!");
      }
    }

    // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø­Ø¬Ø²
    document.getElementById("bookingForm").addEventListener("submit", function(e) {
      e.preventDefault();
      removeExpiredBookings();
      const formData = new FormData(e.target);
      const newBooking = {
        user: formData.get("user"),
        phone: formData.get("phone"),
        email: formData.get("email"),
        time: formData.get("time"),
        created_at: Date.now()
      };
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙƒØ±Ø§Ø± Ø§Ù„Ø­Ø¬Ø² Ù„Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª
      const isTimeTaken = bookings.some(booking => booking.time === newBooking.time);
      if (isTimeTaken) {
        alert("Ù‡Ø°Ø§ Ø§Ù„ÙˆÙ‚Øª Ù…Ø­Ø¬ÙˆØ² Ø¨Ø§Ù„ÙØ¹Ù„ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙˆÙ‚Øª Ø¢Ø®Ø±!");
        return;
      }
      bookings.push(newBooking);
      alert(`Ø´ÙƒØ±Ø§Ù‹ ${newBooking.user} Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬Ø² ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© ${newBooking.time}!`);
      e.target.reset();
      updateBookingsTable();
    });

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    updateBookingsTable();
  </script>
</body>
</html>
